/* Copyright (c) Ericsson 2019 */

define("chartlib/charts/_base/Grid",["chartlib/base/d3"],function(t){"use strict";return function(a,i){function r(){var t=T+"AxisClipPath-"+y.id,a=W+"AxisClipPath-"+y.id;b=v.append("clipPath"),b.attr("id",t).append("rect"),A=v.append("clipPath"),A.attr("id",a).append("rect"),M=w.append("g").attr("fill",j.theme.grid.axis.fill).attr("shape-rendering","geometricPrecision").attr("class","entriesAxisG").attr("clip-path","url(#"+t+")"),P=w.append("g").attr("fill",j.theme.grid.axis.fill).attr("shape-rendering","geometricPrecision").attr("class","valuesAxisG").attr("clip-path","url(#"+a+")"),S=w.append("g"),S.append("polygon").attr("points","0.331,-0.331 4.654,2.163 0.331,4.654").attr("fill",j.theme.grid.axis.fill),z=w.append("g"),z.append("polygon").attr("points","0,4.323 2.494,0 4.985,4.323").attr("fill",j.theme.grid.axis.fill)}function e(){C=v.append("clipPath"),C.attr("id","lineWrapperClipPath-"+y.id).append("rect").attr("class","lineWrapper"),B=w.append("g"),B.attr("clip-path","url(#lineWrapperClipPath-"+y.id+")"),E=w.append("g"),E.attr("clip-path","url(#lineWrapperClipPath-"+y.id+")")}function n(t){if(j.grid.axisLabels[t])return w.append("g").attr("class",t+"AxisLabel").append("text").text(j.grid.axisLabels[t]).attr("fill",j.theme.grid.text.fill).attr("dy","0.75em").attr("text-anchor","middle")}function l(a){var i=j.grid.tickFormat[a],r=j.plotOptions.scaleType[a];if(i){var e;"string"==typeof i?e="time"===r?t.time.format(i):t.format(i):"function"==typeof i&&(e=i),V[a]=e}}function s(a,i,r,e,n){n=n||{};var l,s,o,c=j.theme.grid,g=j.grid,p=d(e),f=i.margins,y=u(W,i),m=g.tickSize.y,v=i[k?"width":"height"],w=k?"bottom":"left",b=f.left-3,M=f.top-3,S=t.svg.axis().tickSize(1).tickPadding(g.tickPadding.y).scale(r.y).orient(w);P.attr("transform","translate("+y.x+","+y.y+")"),A.selectAll("rect").attr("x",k?-12:-(m.width+12)).attr("y",-6).attr("width",Math.max(0,k?v+40:m.width+g.gridPadding.left+12)).attr("height",Math.max(0,k?40:v+f.left)),h(S,v,r.y.domain(),"y"),p?(l=e.duration,s=e.delay,o=j.animation.easing,P.transition().duration(l).delay(s).ease(o).call(S)):P.call(S),P.selectAll("g.tick text").attr("fill",c.text.fill).style(c.tickStyles);var B=x(z);return B.x===b&&B.y===M||(p?z.attr("transform","translate("+b+","+B.y+")").transition().duration(l).delay(s).ease(o).attr("transform","translate("+b+","+M+")"):z.attr("transform","translate("+b+","+M+")")),S}function o(a,i,r,e,n){n=n||{};var l,s,o=j.theme.grid,c=j.grid,g=c.gridPadding.left,p=void 0!==r.groupedEntries,f=p||g>0,m=c.tickSize.x,v=c.tickPadding.x,w=u(T,i),A=k?"left":"bottom",P=p?r.groupedEntries:r.x,z=i[k?"height":"width"]-g,B=d(e),E=t.svg.axis().tickSize(f?0:1).tickPadding(v).scale(P).orient(A);h(E,z,P.domain(),"x");var C=G.x;p&&(l=r.x.domain(),s=r.groupedEntries.domain(),C=l.length*s.length);var F=m.width,L=n.position,W=i.width,V=i.height,O=i.margins,H=k?F:(W-2*v*C)/C,D=Math.ceil(Math.min(H,F)),I=-D/2+g,_=L&&void 0!==L.y?L.y:6,q=O.left+W,J=O.top+V-1.5;if(b.selectAll("rect").attr("x",k?-D:-25).attr("y",0).attr("width",Math.max(0,k?D:z+g+50)).attr("height",Math.max(0,k?z+40:40)),M.attr("transform","translate("+w.x+","+w.y+")"),f){var K=M.selectAll("line"),N=0,Q=W,R=0,U=0;K.empty()&&(K=M.append("line").attr("stroke-width",1).attr("stroke",o.axis.fill)),k&&(N=-g-1,Q=-g-1,U=V),K.attr("x1",N).attr("y1",R).attr("y2",U),B?K.transition().duration(e.duration).delay(e.delay).ease(j.animation.easing).attr("x2",Q):K.attr("x2",Q)}if(p){var X=function(t){var a=n.group.getGroupCoords(t);return"translate("+a.x+","+a.y+")"},Y=function(t){var a=n.group.getTickCoords(t);return k&&(a.y+=_),"translate("+a.x+","+a.y+")"},Z=M.selectAll("g.group"),$=Z.data(l.map(function(t){return{label:t}}));$.enter().append("g").attr("class","group").attr("transform",X).call(function(){var t=this.selectAll("g.tick").data(s.map(function(t){return{label:t}}));t.enter().append("g").attr("class","tick").append("text").text(function(t){return t.label})}),$.exit().remove(),B?M.selectAll("g.group").transition().duration(e.duration).delay(e.delay).ease(j.animation.easing).attr("transform",X).call(function(){this.selectAll("g.tick").attr("transform",Y)}):M.selectAll("g.group").attr("transform",X).call(function(){this.selectAll("g.tick").attr("transform",Y)})}else B?M.transition().duration(e.duration).delay(e.delay).ease(j.animation.easing).call(E):M.call(E);k&&(I=-D,_=-m.height/2,o.tickStyles["text-align"]="left"),M.selectAll("g.tick").call(function(t){y.wrapTextEllipsis(t,{},{})}),M.selectAll("g.tick .wrappingFobj").attr("x",I).attr("y",_).attr("width",Math.max(0,D)).attr("height",Math.max(0,m.height)),M.selectAll("g.tick .wrappedText").style(o.tickStyles).style("color",o.text.fill);var tt=x(S);return tt.x===q&&tt.y===J||(B?S.attr("transform","translate("+tt.x+","+J+")").transition().duration(e.duration).delay(e.delay).ease(j.animation.easing).attr("transform","translate("+q+","+J+")"):S.attr("transform","translate("+q+","+J+")")),E}function d(t){return t.duration+t.delay>0}function c(t,a,i,r){var e=j.theme.grid.gridLines;e.horizontal&&g(t,a,i,r),e.vertical&&p(t,a,i,r)}function g(t,a,i,r){var e=a.margins,n=i.y,l=j.theme.grid.stroke,s=a.width,o=a.height,c=r.duration,g=r.delay,p=j.animation.easing;C.selectAll("rect").attr("width",Math.max(0,s)).attr("height",Math.max(0,o-1)),B.attr("transform","translate("+e.left+","+e.top+")");var h=B.selectAll("line.gridline").data(n.ticks(G.y)),f=0,u=s,x=n,y=n;k&&(f=n,u=n,x=0,y=o),h.attr("class","update gridline").transition().duration(c).delay(g).ease(p).attr("opacity","1").attr("x1",f).attr("x2",u).attr("y1",x).attr("y2",y);var m=h.enter().append("line").attr("class","enter gridline").attr("x1",f).attr("x2",u).attr("y1",x).attr("y2",y).attr("shape-rendring","crispEdges").attr("stroke",l.fill).attr("stroke-dasharray",l.dashArray);d(r)&&m.attr("opacity","0").transition().duration(c).delay(g).ease(p).attr("opacity","1"),h.exit().transition().duration(.5*c).delay(g).ease(p).attr("opacity","0").remove()}function p(t,a,i,r){var e=a.margins,n=i.x,l=a.height,s=a.width,o=r.duration,c=r.delay,g=j.animation.easing,p=j.theme.grid.stroke;C.selectAll("rect").attr("width",Math.max(0,s)).attr("height",Math.max(0,l-1)),E.attr("transform","translate("+e.left+","+e.top+")");var h=E.selectAll("line.gridline").data(n.ticks(G.x)),f=n,u=n,x=0,y=l;k&&(f=0,u=s,x=n,y=n),h.attr("class","update gridline").transition().duration(o).delay(c).ease(g).attr("opacity","1").attr("x1",f).attr("x2",u).attr("y1",x).attr("y2",y);var m=h.enter().append("line").attr("class","enter gridline").attr("x1",f).attr("x2",u).attr("y1",x).attr("y2",y).attr("shape-rendring","crispEdges").attr("stroke",p.fill).attr("stroke-dasharray",p.dashArray);d(r)&&m.attr("opacity","0").transition().duration(o).delay(c).ease(g).attr("opacity","1"),h.exit().transition().duration(.5*o).delay(c).ease(g).attr("opacity","0").remove()}function h(t,a,i,r){var e=j.grid,n=e.tickValues[r],l=e.tickHint[r],s=e.tickSize[r]["x"===r?"width":"height"],o=j.plotOptions.scaleType[r];if("number"==typeof l||"ordinal"!==o&&"auto"!==l)if("number"==typeof l)t.ticks(l),G[r]=l;else if(n===!0){var d=i.filter(function(t,a){return a%e.dataItemsPerTick.x===0});t.tickValues(d),G[r]=d.length}else n!==!1&&(t.tickValues(n),G[r]=n.length);else{var c=Math.round(Math.max(a,1)/s),g=e.tickHint.max[r];g&&(c=Math.min(g,c)),t.ticks(c),G[r]=c}void 0!==V[r]&&t.tickFormat(V[r])}function f(t){var a=k?L:F,i=k?F:L;if(void 0!==a){var r=t.margins,e=t.height,n=j.chart,l=r.left+t.width/2,s=r.top+e+M.node().getBBox().height,o=a.node().getBBox().height;j.grid.tickPadding.x>o&&(s=n.height-n.margin.bottom-o),k&&(s=r.top+e+(P.node().getBBox().height+6)),a.attr("transform","translate("+l+","+s+")")}if(void 0!==i){var d=j.chart.margin.left,c=parseFloat(t.height/2)+t.margins.top;i.attr("transform","translate("+d+","+c+") rotate(-90)")}}function u(t,a){var i=a.margins,r={x:i.left,y:i.top+a.height},e={x:i.left,y:i.top};return t===T?k?e:r:k?r:e}function x(a){var i=t.transform(a.attr("transform"));return{x:i.translate[0],y:i.translate[1]}}var y,m,v,k,w,A,b,P,M,S,z,B,E,C,F,L,T="entries",W="values",G={},V={},O=0,j={theme:{grid:{tickStyles:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",margin:"0","font-weight":"normal","word-wrap":"break-word","text-align":"center"}}},grid:{axisLabels:{x:!1,y:!1},axisWidth:{y:!1},dataItemsPerTick:{x:1},gridPadding:{left:0,right:0},tickFormat:{x:!1,y:!1},tickHint:{x:"auto",y:"auto",max:{x:8,y:5}},tickPadding:{x:8,y:8},tickSize:{x:{height:20,width:75},y:{height:20,width:40},overflow:{x:"ellipsis",y:"ellipsis"}},tickValues:{x:!1,y:!1}}};this.init=function(){if(y=i,k="horizontal"===y.options.plotOptions.orientation,a.grid===!0){var t=j.grid;j=y.objectMerger(j,a),j.grid=t}else j=y.objectMerger(j,a);m=y.svg,v=y.defs,w=m.append("g"),w.attr("id","gridWrapper-"+y.id),r(),e(),F=n("x"),L=n("y"),l("x"),l("y"),this.yAxisSize=j.grid.axisWidth.y},this.getOptions=function(){return j.grid},this.getEntriesAxisLabelSize=function(){if(void 0!==F)return F.node().getBBox()},this.getValuesAxisLabelSize=function(){if(void 0!==L)return L.node().getBBox()},this.getEntriesAxisFormat=function(){return V.x},this.getValuesAxisFormat=function(){return V.y},this.update=function(t,a,i,r){var e=j.animation,n={duration:O>0?e.transitionDuration:0,delay:O>0?e.transitionDelay:0};s(t,a,i,n,r),o(t,a,i,n,r),c(t,a,i,n),f(a),O++},this.init()}}),define("chartlib/charts/Grid",["chartlib/charts/_base/Grid"],function(t){return t});